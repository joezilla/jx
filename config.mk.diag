# JX Monitor - Diagnostic Configuration
# ======================================
# IMSAI hardware ports with TX busy-wait DISABLED.
# Used to isolate TX flow-control as a hang cause.
# Build: make clean && make basic CONFIG=config.mk.diag

# ----------------------------------------------
# z80pack Installation Path
# ----------------------------------------------
Z80PACK_DIR = ../z80pack

# ----------------------------------------------
# Assembler Configuration
# ----------------------------------------------
Z80ASM = $(Z80PACK_DIR)/z80asm/z80asm

# Assembler flags for 8080 mode
ASM_FLAGS_COMMON = -8 -e32 -l -T -sn -p0
ASM_FLAGS_BIN = $(ASM_FLAGS_COMMON) -fb
ASM_FLAGS_HEX = $(ASM_FLAGS_COMMON) -fh

# ----------------------------------------------
# Simulator Configuration
# ----------------------------------------------
SIMULATOR = $(Z80PACK_DIR)/cpmsim/cpmsim
SIM_FLAGS = -8 -m 00

# ----------------------------------------------
# Serial Configuration
# ----------------------------------------------
# IMSAI SIO ports but with TX busy-wait disabled (SIO_TX_MASK=0).
# 8251 init still runs. RX polling still works.
# Only change vs config.mk: SIO_TX_MASK = 0
#
SIO_DATA    = 12H
SIO_STATUS  = 13H
SIO_RX_MASK = 02H
SIO_TX_MASK = 01H
SIO_8251   = 1

# SIO Channel B (auxiliary serial port)
SIO2_DATA    = 14H
SIO2_STATUS  = 15H
SIO2_RX_MASK = 02H

# ----------------------------------------------
# Optional Modules
# ----------------------------------------------
ENABLE_TERM = 0

# BASIC: 0=none, 1=standalone boot, 2=build loadable hex
ENABLE_BASIC = 0

# ----------------------------------------------
# Version
# ----------------------------------------------
VER_MAJOR = 0
VER_MINOR = 6

# ----------------------------------------------
# Memory Configuration
# ----------------------------------------------
MEM_SIZE = 48

BIOS_BASE = 0
STACK_TOP =

# ----------------------------------------------
# Video Configuration
# ----------------------------------------------
VIDEO_BASE = 0CC00H
VIDEO_CTRL = 0C8H
VIDEO_COLS = 64
VIDEO_ROWS = 16

# ----------------------------------------------
# Build Directories
# ----------------------------------------------
SRC_DIR = src
BUILD_DIR = build
BIOS_DIR = $(SRC_DIR)/bios

# ----------------------------------------------
# Output Files
# ----------------------------------------------
SYSTEM_BIN = $(BUILD_DIR)/jx.bin
SYSTEM_HEX = $(BUILD_DIR)/jx.hex
